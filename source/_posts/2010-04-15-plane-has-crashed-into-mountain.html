---
layout: post
title: "The plane has crashed into the mountain"
date: 2010-04-15
comments: false
---

<div class='post'>
In <a href="http://code.mumak.net/2010/04/all-dude-wanted-was-his-rug-back.html">my previous post</a>, I described all of the steps that I and several others took to get <a href="https://code.edge.launchpad.net/~jml/launchpad/new-zope-testing/+merge/21539">my upgrade</a> to <a href="http://pypi.python.org/pypi/zope.testing">zope.testing</a> landed.<div><br /></div><div>There has been a problem. <a href="https://launchpad.net/subunit">subunit</a> is a dependency of the launchpad-developer-dependencies package, since it's only there for running tests.</div><div><br /></div><div>However, subunit is being imported by our core test support package, <code>lp.testing</code>. That package is being imported by the webapp in production. launchpad-developer-dependencies is not installed in production, launchpad-dependencies is instead. Now that I've removed subunit from our sourcecode dependencies, subunit is no longer installed on production.</div><div><br /></div><div>I broke the rollout.</div><div><br /></div><div>The real problem, apparently, is that we are importing lp.testing in production. That problem always existed, but my patch made it known. And now that we know it, we can't have unnecessary packages installed on our production systems. Not that installing subunit as a package would be any <i>worse</i> than running a production system that relies on really old non-packaged version, but sometimes you've got to draw a line in the sand. Across this line, you do notâ€”</div><div><br /></div><div>Anyway. Since installing subunit as a package is unacceptable, my patch must be reverted, as well as the <a href="https://code.edge.launchpad.net/~jml/launchpad/subunit-by-default/+merge/18449">ec2 test improvement</a> I did based on it. I can land it again when we have fixed the <q>real</q> problem of production code importing test code.</div><div><br /></div><div><b>Update:</b> Just to be crystal clear, I've talked about this and the previous post with my manager before I posted. Both of us want to understand the underlying problems and solve them. </div></div>
