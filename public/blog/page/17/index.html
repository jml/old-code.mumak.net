
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Mere Code</title>
  <meta name="author" content="Jonathan Lange">

  
  <meta name="description" content="While in Argentina, I got around to doing something that I&#8217;ve wanted to do for ages: refactor Bazaar&#8217;s &#8220;serve&#8221; command. It&# &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://code.mumak.net/blog/page/17/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Mere Code" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">(</div>
  	<div id="logoText">jml</div>
  	<div id="logoRight">)</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">Mere Code</a></h1>
  
    <h2>Diverse Topics of General Interest to the Practicing Programmer</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:code.mumak.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About this blog</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2009/02/bazaar-commands.html">Bazaar commands</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2009-02-04T00:00:00+00:00" pubdate data-updated="true">2009-02-04 Wednesday</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
While in Argentina, I got around to doing something that I&#8217;ve wanted to do for ages: refactor Bazaar&#8217;s &#8220;serve&#8221; command. It&#8217;s been bugging me for a while, since we actually duplicate some of that code in Launchpad, and we keep getting bitten by changes to <code>cmd_serve</code>. There&#8217;s also another, deeper reason why I wanted to do it.<br /><br />Bazaar isn&#8217;t just a version control system, it&#8217;s also a very good version control <span style="font-style: italic;">library</span>. It&#8217;s very easy to figure out, use and test. I&#8217;m almost tempted to say &#8220;beautiful&#8221;. In any case, if you&#8217;re writing a Python library, you should probably copy bzrlib.<br /><br />Except for bzrlib/builtins.py, which is where all of the built-in commands like &#8220;serve&#8221; live. For one reason or another, it&#8217;s full of massive <code>run()</code> methods. Many of these methods contain logic that plugin authors end up copying and pasting â€” blech.<span style="font-family:arial;"></span> Hence, refactoring <code>cmd_serve</code>.<br /><br />If you are keen to learn how a version control system works, you could do a lot worse than dive into bzrlib/builtins.py, figure out what a particular command is doing, then refactor that command so the code speaks for itself. There are 64 commands in core Bazaar: get cracking!</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>lifeless<span class='comment-date'> on 2009-02-05 23:44</span></div>
<div class='content'>
IMO its because we conflate UI rendering and UI workflow, in builtins.py. I&#8217;ve thought for a while now that an intermediate layer would help - something containing the program logic that is not about trees/branches/repos/etc.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2009/02/launchpad-and-bazaar-in-south-america.html">Launchpad and Bazaar in South America</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2009-02-03T00:00:00+00:00" pubdate data-updated="true">2009-02-03 Tuesday</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
Just got back to Australia after a couple of weeks in Brazil and Argentina.<br /><br />Three big things:<br /><ol><li>This year, we are going to rock hard on Bazaar.</li><li>We are finally looking seriously at <a href="http://news.launchpad.net/launchpad-performance-week/introducing-launchpad-performance-weeks">improving Launchpad&#8217;s performance</a> across the site.</li><li>The Code team has a lot to do, and not much time to do it.</li></ol>More later.</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>jml<span class='comment-date'> on 2009-02-04 21:07</span></div>
<div class='content'>
It means to do extremely well, but also to put in a great deal of fun effort. Like a rockstar during a guitar solo.</div>
</div>
<div class='comment'>
<div class='author'>Alexander B<span class='comment-date'> on 2009-02-04 19:19</span></div>
<div class='content'>
what it means: &#8220;rock hard&#8221;?</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2009/01/emacs-keybinding-of-dvorak-death.html">Emacs keybinding of (Dvorak) death</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2009-01-05T00:00:00+00:00" pubdate data-updated="true">2009-01-05 Monday</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
From the Emacs help<br /><blockquote>C-x C&#8211; runs the command text-scale-adjust, which is an interactive autoloaded<br />Lisp function.<br /><br />It is bound to C-x C-+, C-x C&#8211;, C-x C-=, C-x C-0.<br /><br />(text-scale-adjust &amp;optional INC)<br /><br />Increase or decrease the height of the default face in the current buffer.<br /><br />The actual adjustment made depends on the final component of the<br />key-binding used to invoke the command, with all modifiers removed:<br /><br />   +, =   Increase the default face height by one step<br />   -      Decrease the default face height by one step<br />   0      Reset the default face height to the global default<br /></blockquote>C-x C&#8211; is really, really close to C-x C-s on a Dvorak keyboard. If ever you hit it by accident, hit C-x C-0 to get your Emacs looking right.</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2008/12/your-code-sucks-and-i-hate-you.html">Your Code Sucks and I Hate You</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2008-12-24T00:00:00+00:00" pubdate data-updated="true">2008-12-24 Wednesday</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
I&#8217;ve just uploaded my OSDC 2008 paper, titled <a href="http://mumak.net/stuff/your-code-sucks.html">Your Code Sucks and I Hate You</a>. It&#8217;s about the social dynamics of code review.<br /><br />Tell me what you think.<br /><br /><span style="font-weight: bold;">Update:</span> The paper was lost, now it&#8217;s found.</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>jml<span class='comment-date'> on 2009-03-12 02:17</span></div>
<div class='content'>
Fixed.</div>
</div>
<div class='comment'>
<div class='author'>jml<span class='comment-date'> on 2009-03-11 23:25</span></div>
<div class='content'>
Sorry about that! I reinstalled my server and lost some data. I&#8217;ll restore the talk as soon as I get the chance &#8211; I&#8217;m on a business trip at the moment.</div>
</div>
<div class='comment'>
<div class='author'>cee-dub<span class='comment-date'> on 2009-03-11 17:10</span></div>
<div class='content'>
I&#8217;d love to read this. &#8220;Your Link Is Broken and I Hate You!&#8221;</div>
</div>
<div class='comment'>
<div class='author'>antonioavmelo<span class='comment-date'> on 2009-03-10 17:24</span></div>
<div class='content'>
Te link appears to be broken. I read this post on the past and it seemed quite good. I&#8217;d like to review it. Thanks.</div>
</div>
<div class='comment'>
<div class='author'>jml<span class='comment-date'> on 2008-12-28 01:18</span></div>
<div class='content'>
Thanks Salgado! I&#8217;ve fixed it up.</div>
</div>
<div class='comment'>
<div class='author'>salgado<span class='comment-date'> on 2008-12-28 01:12</span></div>
<div class='content'>
Nice paper, Jono!<BR/><BR/>I think you&#8217;re missing a &#8220;least&#8221; in this sentence, though.  &#8220;If a chunk of code has been reviewed by someone else, then there are at [least] two people in the world who can understand it.&#8221;</div>
</div>
<div class='comment'>
<div class='author'>Willy Ci<span class='comment-date'> on 2008-12-25 23:42</span></div>
<div class='content'>
should it be <BR/>&#8220;You think my code suck, and I hate you&#8221;</div>
</div>
<div class='comment'>
<div class='author'>jelmer<span class='comment-date'> on 2008-12-25 21:31</span></div>
<div class='content'>
Well summarised !<BR/><BR/>You mention that in the case of disputed matters, the patch reviewer makes the final decision in the case of Bazaar. It seems to me like that usually when there is disagreement between the patch author and the review(ers) the patch gets stalled and eventually the project leader (Martin) makes the final decision.</div>
</div>
<div class='comment'>
<div class='author'>spiv<span class='comment-date'> on 2008-12-24 13:02</span></div>
<div class='content'>
Your paper sucks and I hate you. ;)<BR/><BR/>Merry Christmas!</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2008/12/stacked-branches-and-new-world.html">Stacked branches and the new world</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2008-12-15T00:00:00+00:00" pubdate data-updated="true">2008-12-15 Monday</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
A few months ago, we rolled out a version of Launchpad that supports and encourages <span style="font-style: italic;">stacked branches</span>. This means medium to large size projects are be able to use Launchpad for hosting their code. I wrote this post shortly before the roll-out, but never got around to blogging it. Hope you enjoy it.<br /><br /><span style="font-weight: bold;">The Problem</span><br />As far as code goes, Launchpad thinks in terms of individual Bazaar branches. Each of these Bazaar branches stands alone, isolated from other branches. Further, each of these branches has the full history of whatever project they are a branch of.<br /><br />That means that every time you push a branch up to Launchpad, you have to push the <span style="font-style: italic;">entire history</span> of your project. That&#8217;s not a problem for small projects, but for large projects it&#8217;s simply unacceptable. It takes well over an hour for me to push up a branch of Bazaar, for example.<br /><br />On our side, we simply don&#8217;t have the space to store hundreds of copies of the full history of every Free Software project in the world.<br /><br /><span style="font-weight: bold;">The Shape of the Solution</span><br />The answer to both of these problems is to share history information between branches. That way, when you push a new branch, you would only have to push up the data that&#8217;s unique to that branch, the changes that you&#8217;ve made locally. Similarly, we&#8217;d only need to store those changes, rather than another full copy of the history.<br /><br /><span style="font-weight: bold;">Shared Repositories?</span><br />Experienced users of Bazaar might be wondering why we didn&#8217;t just use shared repositories. A repository is like a big bucket full of Bazaar revisions. A repository can be made a shared repository, and branches can be made to get their revisions from <span style="font-style: italic;">that</span> repository, rather than from their own. This works fine in many circumstances, but for a public service like Launchpad, it&#8217;s not good enough.<br /><br />First, people can put poison the bucket. If you can push up a branch, you can write to the shared repository. If you can write to a shared repository at all, then you can write to <span style="font-style: italic;">any</span> revision in that shared repository. This means  malicious users could poison any repository that they can push to. If we had a shared repository per project, then malicious users could push up branches that change a project&#8217;s history.<br /><br />A shared repository per person, per project is not so bad, but it&#8217;s not so good either. In that model, users would have to push up the full history of a project the first time they contributed a project. <span style="font-style: italic;">Blech.</span> The last thing we want to do is penalize someone for contributing to a new project. Launchpad is supposed to make it easy for you to get started.<br /><br /><span style="font-weight: bold;">Stacked Branches</span><br />A stacked branch is a branch that only has a little bit of its own history. The rest of its history lives in another branch, what we call the <span style="font-style: italic;">stacked-on branch</span> (I don&#8217;t like the name, but all the better ones are taken). The Bazaar team has been working on making Bazaar support stacked branches for much of this year.<br /><br />Stacked branches are exactly what Launchpad needs to get you pushing your branches up quickly. When you push up a stacked branch, you only need write access to the repository of <span style="font-style: italic;">that branch</span>, you only need to read the stacked-on branch. This eliminates the poisoning problem, and allows revisions to be shared safely between branches.<br /><br /><span style="font-weight: bold;">How We Do It<span style="font-weight: bold;"><span style="font-weight: bold;"></span></span></span><br />For each project with a development focus (Launchpad&#8217;s jargon for an official trunk), Launchpad has a policy file that tells Bazaar that new branches should be stacked on that development focus.<br /><br />So, you make a branch from trunk, do a bit of hacking locally, commit a few revisions and push it up to Launchpad as your own branch, say lp:~jml/tribunal/awesome-new-feature. When you push, Bazaar asks Launchpad where it should stack the branch, and Launchpad says lp:~jml/tribunal/trunk. Bazaar then pushes only the new revisions I&#8217;ve added to my &#8220;awesome-new-feature&#8221; branch.<br /><br />We do a lot of stuff behind the scenes to make sure the branches work over HTTP, bzr+ssh, SFTP and to make sure that mirrored branches work just as well as hosted branches and so on. I hope that most of this is invisible to you, and that you simply notice that pushing big branches to Launchpad suddenly got a lot faster.<br /><br /><span style="font-weight: bold;">The Future</span><br />By making it possible to quickly push big branches to Launchpad, we&#8217;ve entered a new era. Projects like Bazaar and Launchpad itself can start actually hosting their branches on Launchpad. For other projects (like Twisted, Python or even GNOME), hosting branches on Launchpad is now an option that can be seriously considered.<br /><br />For my part, stacked branches are already changing the way I work. I&#8217;m now using the product that I helped build each and every day as part of my job. Further, my colleagues and my boss are also using it. This quickly exposes rough edges and raises obvious ideas for improvement in the rest of the Code site. It also helps me see which bugs are the really important ones.<br /><br />More importantly, it&#8217;s reminded me that Launchpad actually is pretty cool. I&#8217;m using it more, and looking forward to the day when I can really, genuinely say that Launchpad is a joy to use.</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Eduardo de Oliveira Padoan<span class='comment-date'> on 2008-12-15 16:00</span></div>
<div class='content'>
Thanks for this post, Its exactly the kinfd of thing I like to read at Planet Bazaar.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2008/12/explaining-version-control-to-non.html">Explaining Version Control to Non-Programmers</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2008-12-15T00:00:00+00:00" pubdate data-updated="true">2008-12-15 Monday</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<a href="http://life.mumak.net/2008/12/version-control.html">As I mentioned</a> on <a href="http://life.mumak.net/">my other blog</a>, I really struggle to explain version control to non-programmers. In particular, I don&#8217;t know how to communicate just how <span style="font-style: italic;">cool</span> it is.<br /><br /><a href="http://randsinrepose.com">Rands</a> has a go at it by explaining that it&#8217;s all about <a href="http://www.randsinrepose.com/archives/2006/03/23/capturing_context.html">capturing context</a>. How do you explain Bazaar (or anything other version control) to the people you meet?</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Bice Dibley<span class='comment-date'> on 2008-12-17 01:55</span></div>
<div class='content'>
Depends on who I&#8217;m talking to, but I have described version control as &#8220;Like track changes in Word, but for hundreds of documents at once.&#8221; It&#8217;s not really true, but it does get people into the right ballpark.</div>
</div>
<div class='comment'>
<div class='author'>Gary van der Merwe<span class='comment-date'> on 2008-12-16 14:03</span></div>
<div class='content'>
I ask them if they have ever edited Wikipedia, and if they have, I point out version control features in Wikipedia to them, and how they help people to collaborate.<BR/><BR/>For programmers that are new to version control, I point them to http://www.ericsink.com/scm/source_control.html which is and excellent and comprehensive guide to version control. It is pre-dvcs, so it could do with an update.</div>
</div>
<div class='comment'>
<div class='author'>jml<span class='comment-date'> on 2008-12-16 04:53</span></div>
<div class='content'>
Yeah, that&#8217;s what I end up saying as well. But, I&#8217;d like to have something better in reserve for people who are interested enough to know details.</div>
</div>
<div class='comment'>
<div class='author'>spiv<span class='comment-date'> on 2008-12-16 04:47</span></div>
<div class='content'>
I tell them that I work on a tool that helps programmers collaborate.  That&#8217;s a bit abstract and vague (lots of different kinds of tools could do that), but somewhat comprehensible.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2008/12/repost.html">Repost</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2008-12-14T00:00:00+00:00" pubdate data-updated="true">2008-12-14 Sunday</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
I&#8217;ve reposted my old <span style="font-style:italic;"><a href="http://mumak.net/stuff/twisted-disconnect.html">How to disconnect in Twisted, really</a></span> article to the <a href="http://mumak.net/stuff">Stuff and Nonsense</a> section of my website. Enjoy.</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2008/12/everything-you-always-wanted-to-know.html">Everything You Always Wanted to Know About Twisted</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2008-12-14T00:00:00+00:00" pubdate data-updated="true">2008-12-14 Sunday</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
A couple of months ago, all of the Launchpad developers met in London to have an Epic. Some of us wrote technical papers which we presented at the conference.<br /><br />My paper was an <a href="http://mumak.net/stuff/twisted-intro.html">introduction to Twisted</a>, co-written with Michael Hudson and aimed specifically at the Launchpad developers, who are often wary of Twisted&#8217;s magical powers and raw animal charisma. The paper got published in a neat booklet (thanks Matt!), and the talk went fairly well. Since the paper is actually a fairly generic introduction, I thought it might be worth in the <a href="http://mumak.net/stuff">Stuff and Nonsense</a> section.<br /><br />It assumes that you know how to write Python code, that you know roughly what an event loop is, and that you are comfortable with network programming in general. When you are finished, you should know enough about Twisted to start investigating how you can use it to solve your specific problems.<br /><br />It doesn&#8217;t cover Failures or returning Deferreds from callbacks or errbacks, which is a fairly serious gap. If you think the paper is good and you&#8217;d like to see these gaps filled, email me, or comment on this post. Otherwise, let me know what you think!</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2008/12/anonymized-irc.html">Anonymized IRC?</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2008-12-14T00:00:00+00:00" pubdate data-updated="true">2008-12-14 Sunday</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<span style="font-family: arial;">Crazy idea: a chat server which anonymized the nicks of all users, changing them around at frequent intervals. The server would require authentication, but the results of that authentication are kept secret from other users.<br /><br />Would it be interesting? Would it work?<br /></span></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>jml<span class='comment-date'> on 2008-12-14 21:58</span></div>
<div class='content'>
Jason, no uses per se. Just an experiment.<BR/><BR/>Mary, I think that there definitely needs to be some sort of expulsion mechanism to deal with abusers. Not sure what to do about awkward confessions though.</div>
</div>
<div class='comment'>
<div class='author'>Mary<span class='comment-date'> on 2008-12-14 20:44</span></div>
<div class='content'>
I&#8217;ve seen a set of blog regulars do this voluntarily. It ended up being kind of amusing for a while, except for the one who took advantage of it to attack another regular. They ended up needing to drop masks early.<BR/><BR/>Same blog has an occasional convention of formal psuedonym-change to confess more uncomfortable secrets, but one confessed to being a rapist, that was a little awkward too.<BR/><BR/>So yeah, I do wonder how often it would be used to be either unpleasantly mean or unpleasantly revealing.</div>
</div>
<div class='comment'>
<div class='author'>Jason<span class='comment-date'> on 2008-12-14 07:24</span></div>
<div class='content'>
What sort of uses are you envisaging?</div>
</div>
<div class='comment'>
<div class='author'>jml<span class='comment-date'> on 2008-12-14 06:23</span></div>
<div class='content'>
No it wouldn&#8217;t. Like I said, you would still need a username and password to log on, so the owner of the server knows which <I>set</I> of people have access, just not who says any one thing.</div>
</div>
<div class='comment'>
<div class='author'>Calvin Spealman<span class='comment-date'> on 2008-12-14 05:41</span></div>
<div class='content'>
It is important that we CAN be anonymous, but the end I fear it only is defeatist. When you can say things only because no one knows who said it, you avoid the steps needed to say it with a name tag on.<BR/><BR/>Besides, it would just get used to trade kiddie porn.</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2008/11/doctests.html">Doctests</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2008-11-21T00:00:00+00:00" pubdate data-updated="true">2008-11-21 Friday</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<a href="http://andrew.puzzling.org/">Andrew</a> has written about why <a href="http://andrew.puzzling.org/diary/2008/October/23/narrative-tests">narrative tests make lousy unit tests</a> and <a href="http://andrew.puzzling.org/diary/2008/October/24/more-doctest-problems">problems with the doctest format</a>. In summary:<br /><ul><li>Unit tests work better if each one has a name that identifies it.</li><li>Specific, isolated tests give clearer failures, and are easier to debug.</li><li>Specific, narrow tests are better at communicating intended behaviour.</li><li>Comparing two objects in doctests is hard.</li><li>It&#8217;s hard to get an overview of what&#8217;s tested in a particular doctest file.</li><li>Doctest is a mini-language that&#8217;s worse than Python. It&#8217;s got corner-cases and outright bugs.</li><li><span style="font-weight: bold;">Tests are code, and code works better in .py files than .txt files.</span> In particular:<ul><li>Python has better tool support. Syntax highlighting, code folding, pyflakes, 2to3 etc.<br /></li><li>It&#8217;s easier to build test infrastructure in Python.</li><li>Test code benefits from refactoring as much as regular code, but doctests make it hard to do this.</li></ul></li></ul>Of course, in the end, it comes down to this:<br /> <blockquote>It is just as possible to write incomprehensible tests using doctest as it is using <code>TestCase</code> classes with test methods.<br /></blockquote></div>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/18/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/16/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/04/deliberately-being-naughty.html">Deliberately being naughty</a>
      </li>
    
      <li class="post">
        <a href="/2013/02/testtools-moved-to-github.html">testtools moved to Github</a>
      </li>
    
      <li class="post">
        <a href="/2013/02/are-single-variable-names-evil.html">Are single letter variable names evil?</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/getting-set-up-with-twisted-development.html">Getting set up with Twisted development</a>
      </li>
    
      <li class="post">
        <a href="/2012/11/whats-wrong-with-orms.html">What&#8217;s wrong with ORMs</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/jml">@jml</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'jml',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/jonathan.lange?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Jonathan Lange -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
